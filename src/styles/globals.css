@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --background: #fafbfc;
  --foreground: #111827;
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
  --bottom-nav-height: 3.5rem;
  --header-height: 3.5rem;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
  /* Prevent overscroll bounce on iOS — gives app feel */
  overscroll-behavior: none;
  /* Prevent pull-to-refresh in standalone PWA */
  overflow: hidden;
  height: 100%;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: var(--font-inter), Arial, Helvetica, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Disable tap highlight — native apps don't have it */
  -webkit-tap-highlight-color: transparent;
  /* Prevent text selection on UI elements */
  -webkit-touch-callout: none;
  /* Enable hardware acceleration */
  -webkit-transform: translateZ(0);
  /* Full height for app shell */
  height: 100%;
  overflow: auto;
  overscroll-behavior-y: contain;
}

/* ---- Mobile App Feel ---- */

/* Disable text selection on interactive elements */
button, a, nav, [role="button"] {
  -webkit-user-select: none;
  user-select: none;
}

/* Allow text selection in content areas */
p, span, h1, h2, h3, h4, h5, h6, input, textarea {
  -webkit-user-select: auto;
  user-select: auto;
}

/* iOS momentum scrolling */
.scroll-touch {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
}

/* Active state press effect — makes buttons feel tactile */
@media (hover: none) and (pointer: coarse) {
  .press-effect {
    transition: transform 0.1s ease, opacity 0.1s ease;
  }
  .press-effect:active {
    transform: scale(0.96);
    opacity: 0.85;
  }

  /* Tab press effect — subtle, fast */
  .tab-press:active {
    transform: scale(0.9);
    opacity: 0.7;
    transition: transform 0.05s ease, opacity 0.05s ease;
  }

  /* List item press — subtle highlight */
  .list-press:active {
    background-color: rgba(255, 255, 255, 0.08) !important;
    transition: background-color 0.05s ease;
  }
}

/* ---- Slide Transitions ---- */
.slide-in-right {
  animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
.slide-out-right {
  animation: slideOutRight 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
.slide-in-up {
  animation: slideInUp 0.35s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
.slide-in-down {
  animation: slideInDown 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
.fade-in {
  animation: fadeIn 0.2s ease forwards;
}
.fade-in-up {
  animation: fadeInUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
.scale-in {
  animation: scaleIn 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

@keyframes slideInRight {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}
@keyframes slideOutRight {
  from { transform: translateX(0); }
  to { transform: translateX(100%); }
}
@keyframes slideInUp {
  from { transform: translateY(100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes slideInDown {
  from { transform: translateY(-100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}

/* Message appear animation */
.msg-appear {
  animation: msgAppear 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
@keyframes msgAppear {
  from { opacity: 0; transform: translateY(8px) scale(0.97); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* Send button pulse */
.send-pulse {
  animation: sendPulse 0.3s ease;
}
@keyframes sendPulse {
  0% { transform: scale(1); }
  50% { transform: scale(0.85); }
  100% { transform: scale(1); }
}

/* Skeleton loading shimmer */
.skeleton {
  background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: 8px;
}
@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Pull indicator */
.pull-indicator {
  transition: transform 0.2s ease, opacity 0.2s ease;
}

/* Badge pulse for unread */
.badge-pulse {
  animation: badgePulse 2s ease-in-out infinite;
}
@keyframes badgePulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.15); }
}

/* Hide scrollbar utility */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Community-specific thin scrollbar */
.community-scroll::-webkit-scrollbar {
  width: 3px;
}
.community-scroll::-webkit-scrollbar-track {
  background: transparent;
}
.community-scroll::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.1);
  border-radius: 99px;
}

/* Safe area padding utilities */
.safe-area-top {
  padding-top: var(--safe-area-top);
}
.safe-area-bottom {
  padding-bottom: var(--safe-area-bottom);
}

/* Scrollbar — light theme */
::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-track {
  background: #f3f4f6;
}
::-webkit-scrollbar-thumb {
  background: #933548;
  border-radius: 99px;
}
::-webkit-scrollbar-thumb:hover {
  background: #7B2D3B;
}

/* Selection */
::selection {
  background: #FDF2F4;
  color: #5C1F2C;
}

/* ---- iOS Input Fixes ---- */
/* Prevent iOS zoom on input focus */
@media screen and (max-width: 768px) {
  input, select, textarea {
    font-size: 16px !important;
  }
}

/* Fix iOS fixed positioning with keyboard */
@supports (-webkit-touch-callout: none) {
  .ios-keyboard-fix {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
  }
}

@layer components {
  .section-container {
    @apply mx-auto max-w-7xl px-4 sm:px-6 lg:px-8;
  }

  .section-padding {
    @apply py-16 sm:py-20 lg:py-24;
  }

  .burgundy-gradient {
    background: linear-gradient(135deg, #933548 0%, #7B2D3B 50%, #5C1F2C 100%);
  }

  .burgundy-gradient-soft {
    background: linear-gradient(135deg, #FDF2F4 0%, #E8C4CB 50%, #FDF2F4 100%);
  }

  .burgundy-text {
    @apply text-ewc-burgundy;
  }

  /* ---- Buttons ---- */
  .btn-burgundy {
    @apply inline-flex items-center justify-center px-6 py-3 bg-ewc-burgundy text-white font-heading font-semibold 
           rounded-lg transition-all duration-300 hover:bg-ewc-burgundy-hover hover:shadow-warm-lg
           active:bg-ewc-burgundy-dark focus:outline-none focus:ring-2 focus:ring-ewc-burgundy/40 focus:ring-offset-2 
           focus:ring-offset-white text-sm uppercase tracking-wider;
  }

  .btn-outline {
    @apply inline-flex items-center justify-center px-6 py-3 border-2 border-ewc-burgundy text-ewc-burgundy font-heading 
           font-semibold rounded-lg transition-all duration-300 hover:bg-ewc-burgundy hover:text-white
           focus:outline-none focus:ring-2 focus:ring-ewc-burgundy/40 focus:ring-offset-2 focus:ring-offset-white
           text-sm uppercase tracking-wider;
  }

  .btn-white {
    @apply inline-flex items-center justify-center px-6 py-3 bg-white text-ewc-charcoal font-heading font-semibold 
           rounded-lg transition-all duration-300 hover:bg-ewc-snow shadow-soft
           focus:outline-none focus:ring-2 focus:ring-white/60 focus:ring-offset-2 focus:ring-offset-ewc-navy
           text-sm uppercase tracking-wider;
  }

  .btn-navy {
    @apply inline-flex items-center justify-center px-6 py-3 bg-ewc-navy text-white font-heading font-semibold 
           rounded-lg transition-all duration-300 hover:bg-ewc-navy-light shadow-soft
           focus:outline-none focus:ring-2 focus:ring-ewc-navy/30 focus:ring-offset-2 focus:ring-offset-white
           text-sm uppercase tracking-wider;
  }

  /* ---- Cards ---- */
  .card {
    @apply bg-white rounded-2xl border border-ewc-mist/60 p-6 transition-all duration-300
           hover:shadow-soft-lg hover:border-ewc-burgundy/20 hover:-translate-y-1;
  }

  .card-warm {
    @apply bg-ewc-burgundy-50 rounded-2xl border border-ewc-burgundy-light p-6 transition-all duration-300
           hover:shadow-warm hover:border-ewc-burgundy/30;
  }

  .card-dark {
    @apply bg-ewc-navy rounded-2xl border border-ewc-navy-light p-6 transition-all duration-300
           hover:border-ewc-burgundy/30 hover:shadow-warm;
  }

  /* ---- Form elements ---- */
  .input-field {
    @apply w-full px-4 py-3 bg-white border border-ewc-mist rounded-xl text-ewc-charcoal
           placeholder-ewc-silver focus:outline-none focus:border-ewc-burgundy focus:ring-2 focus:ring-ewc-burgundy/20
           transition-all duration-200 shadow-elevation;
  }

  .input-dark {
    @apply w-full px-4 py-3 bg-ewc-navy-light border border-ewc-navy rounded-xl text-white
           placeholder-gray-400 focus:outline-none focus:border-ewc-burgundy focus:ring-2 focus:ring-ewc-burgundy/20
           transition-all duration-200;
  }

  .label-text {
    @apply block text-sm font-heading font-semibold text-ewc-charcoal mb-2 tracking-wide;
  }

  /* ---- Section labels ---- */
  .section-label {
    @apply text-ewc-burgundy font-heading text-xs font-bold uppercase tracking-[0.25em];
  }

  .section-title {
    @apply font-heading font-bold text-3xl sm:text-4xl lg:text-5xl text-ewc-charcoal leading-tight;
  }

  .section-subtitle {
    @apply text-ewc-slate text-lg leading-relaxed max-w-2xl;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  .glass {
    @apply bg-white/80 backdrop-blur-xl border border-white/20;
  }

  .glass-dark {
    @apply bg-ewc-navy/90 backdrop-blur-xl border border-white/10;
  }
}
